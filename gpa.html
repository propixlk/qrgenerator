<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPA Calculator - Uni Help</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
            color: #374151; /* Dark gray text */
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        main {
            flex-grow: 1;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
        
        <!-- Header Section -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-indigo-700">GPA Calculator</h1>
            <p class="text-gray-600 mt-2">Calculate your Semester GPA here.</p>
        </header>

        <!-- Main Content Area -->
        <main>
            <!-- GPA Calculator Section -->
            <div class="bg-white p-6 rounded-lg shadow-md fade-in">
                <div id="gpa-result-container" class="hidden text-center bg-indigo-100 border border-indigo-200 text-indigo-800 p-4 rounded-lg mb-6">
                    <h3 class="font-semibold">Your Semester GPA:</h3>
                    <p id="gpa-result" class="text-3xl font-bold"></p>
                </div>
                <div id="courses-container">
                    <!-- Initial course row -->
                    <div class="course-row grid grid-cols-1 md:grid-cols-10 gap-2 items-center mb-2">
                        <input type="text" placeholder="Course (e.g., CS101)" class="md:col-span-4 p-2 border border-gray-300 rounded-md">
                        <input type="number" min="0" placeholder="Credits" class="md:col-span-2 p-2 border border-gray-300 rounded-md">
                        <select class="md:col-span-3 p-2 border border-gray-300 rounded-md">
                            <option value="A+">A+</option><option value="A">A</option><option value="A-">A-</option><option value="B+">B+</option><option value="B">B</option><option value="B-">B-</option><option value="C+">C+</option><option value="C">C</option><option value="C-">C-</option><option value="D+">D+</option><option value="D">D</option><option value="E">E</option>
                        </select>
                        <button class="md:col-span-1 bg-red-500 text-white p-2 rounded-md hover:bg-red-600 transition-colors duration-300" onclick="removeCourse(this)">X</button>
                    </div>
                </div>
                <div class="flex flex-col md:flex-row gap-4 mt-6">
                    <button onclick="addCourse()" class="flex-1 bg-indigo-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-indigo-600 transition-colors duration-300">Add Another Course</button>
                    <button onclick="calculateGPA()" class="flex-1 bg-green-500 text-white font-bold py-2 px-4 rounded-md hover:bg-green-600 transition-colors duration-300">Calculate GPA</button>
                </div>
                <div class="flex justify-center mt-6">
                    <button onclick="logout()" class="bg-gray-400 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded-md transition-colors duration-300">Logout</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ===================================================================================
        // --- CONFIGURATION (UPDATE YOUR INFORMATION HERE) ---
        // ===================================================================================
        // GPA Grade Points mapping.
        const gradePoints = { 
            'A+': 4.2, 'A': 4.0, 'A-': 3.7, 
            'B+': 3.3, 'B': 3.0, 'B-': 2.7, 
            'C+': 2.3, 'C': 2.0, 'C-': 1.7, 
            'D+': 1.3, 'D': 1.0, 
            'E': 0.0 
        };

        // ===================================================================================
        // --- GPA CALCULATOR FUNCTIONS ---
        // ===================================================================================

        /**
         * Adds a new course input row to the GPA calculator.
         */
        function addCourse() {
            const container = document.getElementById('courses-container');
            const newCourseRow = document.createElement('div');
            newCourseRow.className = 'course-row grid grid-cols-1 md:grid-cols-10 gap-2 items-center mb-2 fade-in';
            newCourseRow.innerHTML = `
                <input type="text" placeholder="Course (e.g., CS101)" class="md:col-span-4 p-2 border border-gray-300 rounded-md">
                <input type="number" min="0" placeholder="Credits" class="md:col-span-2 p-2 border border-gray-300 rounded-md">
                <select class="md:col-span-3 p-2 border border-gray-300 rounded-md">
                    <option value="A+">A+</option><option value="A">A</option><option value="A-">A-</option><option value="B+">B+</option><option value="B">B</option><option value="B-">B-</option><option value="C+">C+</option><option value="C">C</option><option value="C-">C-</option><option value="D+">D+</option><option value="D">D</option><option value="E">E</option>
                </select>
                <button class="md:col-span-1 bg-red-500 text-white p-2 rounded-md hover:bg-red-600 transition-colors duration-300" onclick="removeCourse(this)">X</button>
            `;
            container.appendChild(newCourseRow);
        }

        /**
         * Removes a course input row from the GPA calculator.
         * @param {HTMLElement} button - The remove button element that was clicked.
         */
        function removeCourse(button) {
            button.parentElement.remove();
        }

        /**
         * Calculates and displays the GPA based on entered course credits and grades.
         */
        function calculateGPA() {
            let totalCredits = 0;
            let totalQualityPoints = 0;
            
            // Iterate over each course row to get credits and grades
            document.querySelectorAll('.course-row').forEach(row => {
                const creditsInput = row.children[1]; // The credits input field
                const gradeSelect = row.children[2];  // The grade select field

                const credits = parseFloat(creditsInput.value);
                const grade = gradeSelect.value;

                // Only process if credits is a valid positive number
                if (!isNaN(credits) && credits > 0) {
                    totalCredits += credits;
                    // Get quality points for the grade, default to 0 if grade not found
                    totalQualityPoints += credits * (gradePoints[grade] || 0);
                }
            });

            const resultContainer = document.getElementById('gpa-result-container');
            const gpaResultElement = document.getElementById('gpa-result');

            if (totalCredits > 0) {
                // Calculate GPA and format to 2 decimal places
                gpaResultElement.textContent = (totalQualityPoints / totalCredits).toFixed(2);
            } else {
                // If no valid credits, display 0.00
                gpaResultElement.textContent = "0.00";
            }
            resultContainer.classList.remove('hidden'); // Show the GPA result container
        }

        // ================================================================================
        // --- AUTHENTICATION CHECK AND REDIRECTION ---
        // ================================================================================

        /**
         * Checks if the user is logged in. If not, redirects them to the login page.
         * This prevents direct access to the GPA calculator page without logging in.
         */
        function checkLoginStatus() {
            // Retrieve login status from session storage
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            if (isLoggedIn !== 'true') {
                // If not logged in, redirect to the main page (login page)
                window.location.href = 'index.html'; 
            }
        }

        /**
         * Logs out the current user by clearing the session storage flag and redirecting.
         */
        function logout() {
            sessionStorage.removeItem('isLoggedIn'); // Remove the login flag
            window.location.href = 'index.html'; // Redirect to the main page
        }

        // Initial check on page load
        document.addEventListener('DOMContentLoaded', () => {
            checkLoginStatus(); // Perform login check when the page loads
        });
    </script>

</body>
</html>
